<!-- templates/index.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>RAG Chatbot</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <div class="container">
    <header>
      <h1>Knowledge-Base Chatbot</h1>
      <p class="subtitle">Upload docs, ask questions ‚Äî RAG</p>
    </header>

    <section class="card">
      <h3>Upload Documents (PDF / TXT)</h3>
      <form id="uploadForm">
        <input id="fileInput" type="file" name="files" multiple />
        <button id="uploadBtn" type="button">Upload & Index</button>
        <span id="uploadStatus" class="muted"></span>
      </form>
      <div id="docList" class="muted small"></div>
    </section>

    <section class="card">
      <textarea id="question" placeholder="Ask anything about the uploaded documents..." rows="4"></textarea>
      <div class="controls">
        <label>Top K:
          <select id="topk">
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4" selected>4</option>
            <option value="6">6</option>
          </select>
        </label>
        <button id="askBtn">Ask</button>
      </div>
    </section>

    <section id="answerCard" class="card hidden">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3>Answer</h3>
        <div class="meta">
          <span id="confidence">Confidence: -</span>
          <span id="latency" style="margin-left:12px;color:rgba(255,255,255,0.6)"></span>
        </div>
      </div>

      <div id="tldr" class="tldr"></div>
      <div id="answerText" class="answer"></div>

      <div class="refine">
        <button id="refineBtn">Refine answer</button>
        <button id="copyBtn">Copy answer</button>
        <div id="refineBox" class="hidden">
          <input id="refineInstruction" placeholder="e.g., Be more concise / Give step-by-step" />
          <button id="applyRefine">Apply</button>
        </div>
      </div>

      <h4>Retrieved Passages (click to open document)</h4>
      <ul id="contexts" class="contexts"></ul>

      <div class="rating">
        <button id="thumbUp" class="like">üëç</button>
        <button id="thumbDown" class="dislike">üëé</button>
        <input id="feedbackComment" placeholder="Optional comment for graders" />
      </div>
    </section>

    <footer>
      <small>Local demo ‚Äî models run on CPU. Keep files small for speed.</small>
    </footer>
  </div>

  <script src="/static/script.js"></script>
</body>
</html>
